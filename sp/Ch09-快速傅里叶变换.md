# Ch 09 - 快速傅里叶变换

##  DFT 的运算量

观察
$$
X(k)=\sum_{n=0}^{N-1}x(n)W_N^{nk}
$$
可看出 $N$ 点 DFT 需要 $N^2$ 次复数乘法与 $N(N-1)$ 次复数加法，整体复杂度 ${\bf O}(N^2)$。

现有的最基本的快速傅里叶变换（FFT）算法能够将复杂度降低到 $\frac{N}{2}\log_2N$ 次复数乘法和 $N\log_2N$ 次复数加法，整体复杂度 ${\bf O}(N\log_2N)$。

## 按时间抽选的基2-FFT（DIT-FFT）

首先补充一些 $W_N$ 的性质

- $W_N={\rm e}^{-{\rm j}\frac{2\pi}{N}}$（定义）
- $W_N^n=W_N^{n+rN}$（周期性）
- $W_N^{\pm Nk}=1$
- $W_N^{nk}=W_{N/m}^{nk/m}$（可约性）
- $W_N^{N/2}=-1$
- $W_N^{k+\frac{N}{2}}=-W_N^k$（半周期取负）
- $W_N^{N-n}=W_N^{-n}$（反转）

考虑一偶数长度的序列 $x(n)$，按下标的奇偶性分为两组
$$
x(2r)=x_1(r),~x(2r+1)=x_2(r),~r=0,1,...,\frac{N}{2}-1
$$
那么
$$
X(k)=\sum_{n=0,~n~{\rm even}}^{N-1}x(n)W_N^{nk}+\sum_{n=0,~n~{\rm odd}}^{N-1}x(n)W_N^{nk}\\
=\sum_{r=0}^{N/2-1}x(2r)W_N^{(2r)k}+\sum_{r=0}^{N/2-1}x(2r+1)W_N^{(2r+1)k}\\
=\sum_{r=0}^{N/2-1}x_1(r)W_{N/2}^{rk}+W_N^k\sum_{r=0}^{N/2-1}x_2(r)W_{N/2}^{rk}\\
=X_1(k)+W_N^kX_2(k)
$$
此时 $X_1$ 和 $X_2$ 均为 $N/2$ 点 DFT，相加得到 $X(k)$ 也为 $N/2$ 点。

为进行 $N$ 点 DFT，注意到
$$
W_{N/2}^{rk}=W_{N/2}^{r(k+N/2)}
$$
那么
$$
X_1(k+N/2)=X_1(k)\\
X_2(k+N/2)=X_2(k)
$$
进一步地，$W_N^k=-W_N^{k+N/2}$，那么
$$
X(k+N/2)=X_1(k+N/2)+W_N^{k+N/2}X_2(k+N/2)\\
=X_1(k)-W_N^kX_2(k),~k=0,1,...,\frac{N}{2}-1
$$
这样即补齐了后 $N/2$ 点。

上述推导构成分治算法，考虑 $X(k)$ 和 $X(k+N/2)$ 两式，仅有符号差异，构造蝶形结流图

TODO

